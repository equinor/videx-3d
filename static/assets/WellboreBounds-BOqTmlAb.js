import{j as n}from"./jsx-runtime-CmIOflP4.js";import{r as a}from"./index-KqYmeiyw.js";import{V as q,S as w}from"./CameraManager-BuezL_By.js";import{a as V}from"./useWellboreContext-DkvsaS95.js";import{q as S}from"./limiter-DhBcc_yH.js";import{u as W}from"./canvas-3d-decorator-BhyssXtK.js";const B=a.createContext({current:1/0}),C="wellboreBounds",o=new q,i=new w,y=({id:c,fromMsl:u,boundsSampleSize:d=250,visible:p=!1,children:g})=>{const f=a.useRef(null),l=V(C),[s,j]=a.useState(null),m=a.useMemo(()=>({current:1/0}),[]),M=a.useCallback((e,r)=>{o.copy(r.position),f.current.worldToLocal(o),i.center.set(...e.main.center),i.radius=e.main.radius;const t=i.distanceToPoint(o)/r.zoom;let h=e.sampled.length?Math.max(i.radius,t):Math.max(0,t);t<=0&&e.sampled.length&&(h=e.sampled.reduce((_,x)=>{i.center.set(...x.center),i.radius=x.radius;const v=Math.max(0,i.distanceToPoint(o)/r.zoom);return Math.min(_,v)},e.main.radius)),m.current=h},[m]);return a.useEffect(()=>{l&&S(()=>l(c,u,d),0).then(e=>{if(e){const r={main:{center:[e[0],e[1],e[2]],radius:e[3]},sampled:[]};for(let t=4;t<e.length;t+=4)r.sampled.push({center:[e[t],e[t+1],e[t+2]],radius:e[t+3]});j(r)}})},[c,l,u,d]),W(({camera:e})=>{s&&M(s,e)}),n.jsxs("object3D",{ref:f,children:[n.jsx(B.Provider,{value:m,children:g}),p&&s&&n.jsxs("mesh",{position:s.main.center,children:[n.jsx("sphereGeometry",{args:[s.main.radius,32,16]}),n.jsx("meshBasicMaterial",{color:"green",wireframe:!0,transparent:!0,opacity:.1})]}),p&&s&&s.sampled.map((e,r)=>n.jsxs("mesh",{position:e.center,children:[n.jsx("sphereGeometry",{args:[e.radius,16,8]}),n.jsx("meshBasicMaterial",{color:"gray",wireframe:!0,transparent:!0,opacity:.25})]},r))]})};try{y.displayName="WellboreBounds",y.__docgenInfo={description:"This component is used to provide a `DistanceContext` for a `Wellbore`, which allow the use\nof the `Distance` component to conditionally show/hide other components depending on the distance from the\nwellbore to the camera.",displayName:"WellboreBounds",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},fromMsl:{defaultValue:null,description:"",name:"fromMsl",required:!1,type:{name:"number | undefined"}},boundsSampleSize:{defaultValue:{value:"250"},description:"",name:"boundsSampleSize",required:!1,type:{name:"number | undefined"}},visible:{defaultValue:{value:"false"},description:"",name:"visible",required:!1,type:{name:"boolean | undefined"}}}}}catch{}export{B as D,y as W};
