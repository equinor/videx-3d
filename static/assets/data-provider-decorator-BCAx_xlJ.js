import{g as L}from"./curve-3d-BSYPmKD_.js";import{c as H}from"./numbers-DM6OWwIG.js";import{j as S}from"./jsx-runtime-CmIOflP4.js";import{r as h}from"./index-KqYmeiyw.js";/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const A=Symbol("Comlink.proxy"),C=Symbol("Comlink.endpoint"),I=Symbol("Comlink.releaseProxy"),x=Symbol("Comlink.finalizer"),w=Symbol("Comlink.thrown"),T=e=>typeof e=="object"&&e!==null||typeof e=="function",U={canHandle:e=>T(e)&&e[A],serialize(e){const{port1:t,port2:r}=new MessageChannel;return N(e,t),[r,[r]]},deserialize(e){return e.start(),v(e)}},V={canHandle:e=>T(e)&&w in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},j=new Map([["proxy",U],["throw",V]]);function W(e,t){for(const r of e)if(t===r||r==="*"||r instanceof RegExp&&r.test(t))return!0;return!1}function N(e,t=globalThis,r=["*"]){t.addEventListener("message",function m(n){if(!n||!n.data)return;if(!W(r,n.origin)){console.warn(`Invalid origin '${n.origin}' for comlink proxy`);return}const{id:o,type:l,path:u}=Object.assign({path:[]},n.data),f=(n.data.argumentList||[]).map(d);let i;try{const a=u.slice(0,-1).reduce((s,y)=>s[y],e),c=u.reduce((s,y)=>s[y],e);switch(l){case"GET":i=c;break;case"SET":a[u.slice(-1)[0]]=d(n.data.value),i=!0;break;case"APPLY":i=c.apply(a,f);break;case"CONSTRUCT":{const s=new c(...f);i=K(s)}break;case"ENDPOINT":{const{port1:s,port2:y}=new MessageChannel;N(e,y),i=B(s,[s])}break;case"RELEASE":i=void 0;break;default:return}}catch(a){i={value:a,[w]:0}}Promise.resolve(i).catch(a=>({value:a,[w]:0})).then(a=>{const[c,s]=P(a);t.postMessage(Object.assign(Object.assign({},c),{id:o}),s),l==="RELEASE"&&(t.removeEventListener("message",m),O(t),x in e&&typeof e[x]=="function"&&e[x]())}).catch(a=>{const[c,s]=P({value:new TypeError("Unserializable return value"),[w]:0});t.postMessage(Object.assign(Object.assign({},c),{id:o}),s)})}),t.start&&t.start()}function F(e){return e.constructor.name==="MessagePort"}function O(e){F(e)&&e.close()}function v(e,t){const r=new Map;return e.addEventListener("message",function(n){const{data:o}=n;if(!o||!o.id)return;const l=r.get(o.id);if(l)try{l(o)}finally{r.delete(o.id)}}),k(e,r,[],t)}function p(e){if(e)throw new Error("Proxy has been released and is not useable")}function M(e){return g(e,new Map,{type:"RELEASE"}).then(()=>{O(e)})}const b=new WeakMap,E="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(b.get(e)||0)-1;b.set(e,t),t===0&&M(e)});function G(e,t){const r=(b.get(t)||0)+1;b.set(t,r),E&&E.register(e,t,e)}function Y(e){E&&E.unregister(e)}function k(e,t,r=[],m=function(){}){let n=!1;const o=new Proxy(m,{get(l,u){if(p(n),u===I)return()=>{Y(o),M(e),t.clear(),n=!0};if(u==="then"){if(r.length===0)return{then:()=>o};const f=g(e,t,{type:"GET",path:r.map(i=>i.toString())}).then(d);return f.then.bind(f)}return k(e,t,[...r,u])},set(l,u,f){p(n);const[i,a]=P(f);return g(e,t,{type:"SET",path:[...r,u].map(c=>c.toString()),value:i},a).then(d)},apply(l,u,f){p(n);const i=r[r.length-1];if(i===C)return g(e,t,{type:"ENDPOINT"}).then(d);if(i==="bind")return k(e,t,r.slice(0,-1));const[a,c]=R(f);return g(e,t,{type:"APPLY",path:r.map(s=>s.toString()),argumentList:a},c).then(d)},construct(l,u){p(n);const[f,i]=R(u);return g(e,t,{type:"CONSTRUCT",path:r.map(a=>a.toString()),argumentList:f},i).then(d)}});return G(o,e),o}function q(e){return Array.prototype.concat.apply([],e)}function R(e){const t=e.map(P);return[t.map(r=>r[0]),q(t.map(r=>r[1]))]}const z=new WeakMap;function B(e,t){return z.set(e,t),e}function K(e){return Object.assign(e,{[A]:!0})}function P(e){for(const[t,r]of j)if(r.canHandle(e)){const[m,n]=r.serialize(e);return[{type:"HANDLER",name:t,value:m},n]}return[{type:"RAW",value:e},z.get(e)||[]]}function d(e){switch(e.type){case"HANDLER":return j.get(e.name).deserialize(e.value);case"RAW":return e.value}}function g(e,t,r,m){return new Promise(n=>{const o=X();t.set(o,n),e.start&&e.start(),e.postMessage(Object.assign({id:o},r),m)})}function X(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function ne(e,t){if(!t||t.length<2*4)return null;const[r,,m]=t,n=new Array(t.length/4);for(let a=0,c=0;a<n.length;a++,c+=4)n[a]=[t[c]-r,-t[c+1],m-t[c+2]];const o=L(n,!1);if(!o)return null;const l=t[3],u=t[t.length-1],f=u-l;return{id:e,curve:o,get measuredLength(){return f},get measuredTop(){return l},get measuredBottom(){return u},getPointAtDepth:(a,c=!1)=>{let s=(a-l)/f;return c&&(s=H(s,0,1)),s<0||s>1?null:o.getPointAt(s)}}}const $=h.createContext(null);function J(e){return!!e[C]}const _=({store:e,children:t})=>{const r=h.useMemo(()=>J(e),[e]),m=h.useCallback(()=>e,[e]),n=h.useCallback(()=>r?e[C]():Promise.reject("Unable to connect to store!"),[e,r]);return S.jsx($.Provider,{value:{isRemote:r,connect:m,connectByMessagePort:n},children:t})};try{_.displayName="DataProvider",_.__docgenInfo={description:"Provides sub components with the `DataContext`, which allow connecting to the\n`Store` implementation. You can create your own provider if needed, but it will need to\nprovide an implementation of the `DataContext`.",displayName:"DataProvider",props:{store:{defaultValue:null,description:"",name:"store",required:!0,type:{name:"Store | Remote<Store>"}}}}}catch{}const Q=v(new Worker(new URL(""+new URL("remote-mock-store-DkbkPaKo.js",import.meta.url).href,import.meta.url),{type:"module"})),D=e=>S.jsx(_,{store:Q,children:S.jsx(e,{})});try{D.displayName="DataProviderDecorator",D.__docgenInfo={description:"",displayName:"DataProviderDecorator",props:{}}}catch{}export{D,$ as a,C as c,ne as g,K as p,B as t,v as w};
